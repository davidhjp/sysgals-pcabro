Cabro(input signal A,B,R; output signal O; output int channel C1;)->{
	loop{
		abort(R){
			{await(A);}||{await(B);}
			{+
				int i = get_next();
				sgl_SetChanVal(C1, &i);
			+}
			emit O;
			send C1;
			halt;
		}
	}
}

Buffer(input int channel C1; output int channel C2;)->{
	loop{
		receive C1;
		{+
			int i = *(int*)sgl_GetChanVal(C1);
			push(i);
		+}
		pause;
	}
}
